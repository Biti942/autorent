<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>AutoRent - Dashboard Premium</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background: #0f172a;
      color: #fff;
      padding: 20px;
    }
    header {
      text-align: center;
      margin-bottom: 40px;
    }
    h1 {
      font-size: 2rem;
      color: #38bdf8;
    }
    .btn {
      background-color: #38bdf8;
      border: none;
      color: #0f172a;
      padding: 12px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      transition: 0.3s;
    }
    .btn:hover {
      background-color: #0ea5e9;
    }
    .form-section {
      background-color: #1e293b;
      padding: 20px;
      border-radius: 12px;
      max-width: 800px;
      margin: auto;
    }
    input, textarea {
      width: 100%;
      padding: 12px;
      margin-bottom: 15px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
    }
    label {
      font-weight: 600;
      margin-bottom: 5px;
      display: block;
    }
    .available-switch {
      display: flex;
      align-items: center;
      margin-top: 10px;
    }
    .available-switch input {
      margin-right: 10px;
    }
    .navigation {
      text-align: center;
      margin-top: 30px;
    }
    a {
      color: #facc15;
      text-decoration: none;
      font-weight: bold;
    }
  </style>
</head>
<body>

<header>
  <h1>üéØ Tableau de Bord - Pack Premium</h1>
  <p>Ajoutez et g√©rez vos voitures directement depuis votre espace</p>
</header>

<div class="form-section">
  <h2>‚ûï Ajouter une nouvelle voiture</h2>
  <form>
    <label for="name">Nom de la voiture</label>
    <input type="text" id="name" placeholder="ex: Dacia Logan 2022">

    <label for="image">Image de la voiture</label>
    <input type="file" id="image">

    <label for="price">Prix par jour (en MAD)</label>
    <input type="number" id="price" placeholder="ex: 250">

    <label for="desc">Description</label>
    <textarea id="desc" rows="4" placeholder="√âcrivez une courte description..."></textarea>

    <div class="available-switch">
      <input type="checkbox" id="available">
      <label for="available">Disponible</label>
    </div>

    <button type="submit" class="btn">Ajouter la voiture</button>
  </form>
</div>

<div class="navigation">
  <p>üìä G√©rer l‚Äô√©tat complet de vos voitures : <a href="gerance-premium.html">Aller vers G√©rance Premium</a></p>
</div>
<div class="navigation" style="margin-top: 20px;">
  <p>üßë‚Äçüíª G√©rer votre site vitrine : <a href="site-agent.html">Voir mon site</a></p>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
<script src="firebase.js"></script>

<script>
  const db = firebase.firestore();
  const auth = firebase.auth();
  const form = document.querySelector("form");
  const imageInput = document.getElementById("image");

  auth.onAuthStateChanged(function(user) {
    if (!user) {
      window.location.href = "connexion.html";
    } else {
      const uid = user.uid;

      form.addEventListener("submit", async function(e) {
        e.preventDefault();

        const nom = document.getElementById("name").value.trim();
        const prix = parseFloat(document.getElementById("price").value.trim());
        const desc = document.getElementById("desc").value.trim();
        const disponible = document.getElementById("available").checked;
        const file = imageInput.files[0];

        if (!file || !nom || isNaN(prix)) {
          alert("Remplis tous les champs et ajoute une image.");
          return;
        }

        const reader = new FileReader();
        reader.onloadend = function() {
          const imageUrl = reader.result;

          db.collection("cars").add({
            uid,
            nom,
            prix,
            description: desc,
            imageUrl,
            disponible,
            vidange: "-",
            reservation: "-",
            retour: "-",
            kilometrage: "-",
            credit: "-",
            depenses: "-",
            ca: "-"
          }).then(() => {
            alert("üöó Voiture ajout√©e avec succ√®s !");
            form.reset();
          }).catch((err) => {
            console.error("Erreur :", err);
            alert("Erreur lors de l‚Äôajout.");
          });
        };
        reader.readAsDataURL(file);
      });
    }
  });
</script>
</body>
</html>

